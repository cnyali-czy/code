/*
	Problem:	C.cpp
	Time:		2020-05-02 11:32
	Author:		CraZYali
	E-Mail:		yms-chenziyang@outlook.com 
*/

#define REP(i, s, e) for (register int i(s), end_##i(e); i <= end_##i; i++)
#define DEP(i, s, e) for (register int i(s), end_##i(e); i >= end_##i; i--)
#define DEBUG fprintf(stderr, "Passing [%s] in Line %d\n", __FUNCTION__, __LINE__)

#define chkmax(a, b) (a < (b) ? a = (b) : a)
#define chkmin(a, b) (a > (b) ? a = (b) : a)

#include <cassert>
#include <cmath>
#include <vector>
#include <unordered_set>
#include <unordered_map>
#include <ctime>
#include <algorithm>
#include <iostream>
#include <cstdio>

using namespace std;
const int maxn = 1e5 + 10, MOD = 998244353;
#define i64 long long
int power_pow(i64 base, int b)
{
	i64 ans = 1;
	while (b)
	{
		if (b & 1) (ans *= base) %= MOD;
		(base *= base) %= MOD;
		b >>= 1;
	}
	return ans;
}
#define inv(x) power_pow(x, MOD - 2)

template <typename T>
inline T read()
{
	T ans = 0, flag = 1;
	char c = getchar();
	while (!isdigit(c))
	{
		if (c == '-') flag = -1;
		c = getchar();
	}
	while (isdigit(c))
	{
		ans = ans * 10 + c - 48;
		c = getchar();
	}
	return ans * flag;
}

#define file(FILE_NAME) freopen(FILE_NAME".in", "r", stdin), freopen(FILE_NAME".out", "w", stdout)

int prime[maxn], mu[maxn], p_cnt, bin[maxn], to[maxn];
bool notp[maxn];
struct __init__
{
	__init__(const int n = maxn - 10)
	{
		bin[0] = mu[1] = to[1] = 1;
		bin[1] = 2;
		REP(i, 2, n)
		{
			bin[i] = (bin[i - 1] << 1) % (MOD - 1);
			if (!notp[i])
			{
				mu[prime[++p_cnt] = i] = -1;
				to[i] = i;
			}
			REP(j, 1, p_cnt)
			{
				int tmp = i * prime[j];if (tmp > n) break;
				notp[tmp] = 1;
				if (i % prime[j])
				{
					mu[tmp] = -mu[i];
					to[tmp] = to[i] * prime[j];
				}
				else
				{
					to[tmp] = to[i];
					break;
				}
			}
		}
	}
}__INIT__;
int n, q, a[maxn];
int mem[1005][1005];
vector <int> Div[maxn];

int blg[maxn], invs[maxn];

struct Query
{
	int l, r, id;
	Query() {}
	Query(int l, int r, int id) : l(l), r(r), id(id) {}
	inline bool operator < (const Query &B) const
	{
		if (blg[l] < blg[B.l]) return 1;
		if (blg[l] > blg[B.l]) return 0;
		if (blg[l] & 1) return r < B.r;
		else return r > B.r;
	}
}Q[maxn];
__int128 Ans = 0;
i64 cnt[maxn];
int ans[maxn], m;
int gg1[maxn], gg2[maxn];
unordered_map <int, int> IDDDD;
int STACK[maxn], TOP;
const double alpha = .47;
int Table[maxn]={0,0,640079066,998244353,109353319,703611754,258630203,834170439,47357184,234850878,468018592,350448665,894505507,771331690,592346416,830602276,566041919,146964206,996995078,728130725,334684749,867562783,66392419,369759867,286440488,528936793,390404735,87475255,541834135,261668739,889288319,943795005,631571053,206384913,890413368,230641902,528070363,122884025,421582807,302783069,926918898,625032389,734089790,953768083,876186706,177597015,2555518,172858080,32078146,603693696,94755028,616939624,77970192,464062952,567409650,75946415,396517056,523976929,985138254,674169525,201137364,570607124,137886015,628193651,643445580,785050037,5959678,932875136,834031768,569142161,450846251,382219363,240286014,39221109,882644209,449573260,994426793,499293603,5256453,645803124,668596544,686618076,135331145,250114676,736103754,53319377,850276178,971414616,300161210,842490035,139761612,135569047,577827746,600688386,253439742,783134941,943744652,811874397,613697663,641357017,111915598,152581017,38650143,492753120,339867843,769059811,919628531,580569759,979785668,945619391,542339120,995272619,968830021,887463801,203176081,622589823,746010774,132531303,80477392,675934727,215298369,664013931,381837565,294524064,994661143,571670442,61615201,563952666,98247552,398204155,571167806,669792687,403884018,382450911,530621181,936489934,250652988,876388833,554586707,859430550,787766076,964922591,646313036,255539989,111985315,9986391,19100635,652903254,378041102,340408124,778149907,252514078,560262889,699899474,459548464,142887454,474281535,418812228,346113947,312959555,675089658,875032208,585262018,143295317,972748838,284598978,67418666,306252194,231701243,769596494,799426395,574996920,587884420,704546287,419679053,844377827,537189230,833709401,591127470,59071020,52325592,322903092,255165306,407703693,58804065,285740299,713062556,879780964,118653040,708533178,637194118,188447980,928258058,866843887,107801306,360433219,616963937,615827253,693119897,444875739,846107441,761863010,738536410,982346906,274586406,992231868,48079364,567641944,385196908,53331235,10696245,678422774,202896730,51026819,8271110,188147391,323147077,369532078,927023406,540574610,533745934,30625376,762854645,5034171,334805273,616913098,925364429,990477930,445972047,180086155,339834723,997703260,21086805,311402585,599846730,974740432,422074883,512914336,803847605,764049621,676236481,28573001,917826807,760609289,122604962,365517419,679250050,462177286,878005676,447602602,190301681,537571045,438065627,245741022,392134395,600843196,340706773,491553465,921594464,457971005,579023110,278767374,277520015,773183029,412954470,653463834,880512848,689398724,975494177,377642958,606538562,24032172,73399991,409660016,919864894,535316273,389454102,626143843,941219639,800584168,447210233,483024478,889750744,576522349,983821552,520197440,703699654,912527383,792091972,240121634,432892829,105261934,52651476,388861084,811615479,605533767,165018028,172172210,494010185,426767877,863637212,791434643,80886150,463170115,843987183,158280572,728104396,635709759,959120798,17127714,797946256,422774714,247768149,671353070,696313295,584724593,126986966,683495568,365387912,414792567,220044125,99403917,186656723,66461494,582418330,24969572,678073777,38371275,320599539,410152679,956400991,356169075,153280812,99051160,568965836,655669572,397381538,148020225,804782713,754999096,467240175,876695833,396043836,313806108,373570744,531395069,895505672,863889363,913212838,76192188,919069386,319390138,671786611,324294320,495295487,900589102,26219299,620802961,596577196,846852195,239808666,777098960,547142827,941610151,218631981,153186839,287690791,824288493,825740815,285581372,885121088,275728147,678212860,486576138,235651500,536307059,573531173,646754944,789050356,256546427,915675724,956340993,617478498,448451426,205124571,428048912,600148289,795864602,633801878,766718122,278832455,798829137,928086652,145135835,431714654,215114895,424603061,900375033,911551885,591418214,933117672,442159958,370119575,479186200,725792750,708199730,171096186,358340108,816587442,873748544,107404290,612792300,886979482,5545319,746195093,103402965,50409994,839846228,211886513,418018629,647111550,640599553,975408719,346596913,948643643,406868616,172774625,709604664,699747605,852365087,601311265,85012629,58571841,878014438,260632760,860779070,833105536,819831713,697508828,683769985,427512483,823494488,940380536,717400745,209097362,115965290,227817045,882984264,870105450,100239053,173248649,198170394,300897732,204827615,13653118,165540006,872919326,612010520,292115515,385207,853135552,83731337,389158940,581984878,113198575,18001040,882994618,325311365,914091590,863471576,295841524,761874319,344603878,235707278,571376359,636883899,668132446,895285466,966046996,477087424,680975210,726079567,309613714,771623251,319700846,512016246,681842758,147714194,816583030,57564036,669277562,394013710,929966329,347017965,428800866,486345801,709614082,869733621,48652655,378236564,88437102,180164110,117492862,257985989,502187116,556483313,827057947,390177554,566739005,569645722,190158357,607687296,925497792,966881388,791417143,51571269,897157695,50689767,328778424,280994325,239548324,100375515,224178323,281163580,87325696,865582306,339680555,474554786,943388227,127599106,215969899,764117215,643895609,674031744,672118856,949271383,186970878,768026258,185517513,727820033,574752741,611398804,732052556,985938222,468158798,868222621,736373508,134099560,718593664,57110671,525836713,877293187,672909924,964647231,196073735,854796310,559474500,509069724,229902792,86998814,490070706,188216577,365313525,238768768,665517366,992546320,875631625,200606633,169220757,678840328,323602997,977669161,44484401,638086368,955141310,852955992,744579372,91476166,219410134,854122444,901536090,891228482,990741080,595213448,304320443,949282583,190562782,370909045,969953567,893515165,332361333,305365036,652921972,687669172,572054322,827398869,39583743,887397139,651900522,252833937,53569866,610324874,749050473,465890488,781553717,285405566,310614331,526169044,735140659,324066417,446701890,414897856,159569921,155847480,887503710,292571261,712978963,909626604,92036625,669178313,309268103,769090075,106648583,443215682,42004430,791475286,937689857,524845250,482415033,452668637,49960260,596364175,649377888,452609156,400631383,521648458,369761156,128335930,629007201,64372687,311529036,194401774,173620275,715671623,522270255,720672198,206966347,752309199,51993111,689560174,645256904,878795475,58352363,508960298,804117499,195769914,949069826,231805080,337543123,192626650,79481054,857763624,282386358,741316509,212390747,108067327,436678900,119351536,811645955,842691261,367551303,683472520,524454793,787726436,784766225,959958384,62209149,679260426,212583450,181237091,987189846,630588321,12597426,373653419,75691559,700998569,121007949,230139609,767466913,962265321,342726059,308622841,144403732,766836627,925564210,401607034,613357575,741820504,76016126,234145440,104157711,158731402,153712778,433068537,382009873,472586826,557100401,392267681,744060009,878594339,40824011,181265528,940534234,807132789,959770471,300949350,275333371,586561224,86191850,883867337,524430993,929614105,96697431,150984507,122768892,464080965,107717007,353444800,927987047,644711425,229846353,212768865,134983573,798606066,763380914,515381533,778227108,472983465,235735827,536183492,580712657,169064855,66349405,997593732,81385352,770156501,420866134,730274886,473016653,348940151,342039194,862961144,194873105,490321504,611642149,90113693,364679996,571264506,848814206,266018445,115148212,177693797,799019437,662706551,32734177,79452246,834482022,360791069,964690560,197120516,335279712,60421593,230916010,931164886,528780875,168956400,771813986,782076052,868730281,897801700,647661707,398501153,668120373,718624081,736608927,842572155,948332569,729722652,586173437,956795721,615566111,21925146,728959679,573194372,172788969,25017926,881576032,180393127,895616207,352925890,374633809,267536989,327450112,905205159,419475681,369779221,791223122,15521597,189139132,544819238,308386164,799384345,757733177,372840269,688652782,601162911,302294654,218300363,158725602,626503748,662542680,446031696,763635464,582660976,384233877,789463659,357634702,276075680,833327700,931733164,255101632,314542876,910428839,220792545,77617625,367977945,35013900,867479179,593078783,532593032,175318796,166543804,837648656,358021492,921142641,891516773,185516202,434353251,304585650,472254318,578342742,16541291,740342377,509112610,704864945,989395118,598920206,321032347,935483068,845863213,560872968,715677298,968090223,281582268,337031228,790058942,809947360,727583749,428301196,83548134,285303293,615949193,936609962,95290766,183875664,335701129,224337019,162270602,348912854,263074729,70370246,327750095,422415333,77503833,539715945,864828298,955925269,247370014,386385246,38641476,16955796,837394979,259007098,64418436,400683574,754947247,458579427,740348509,593548292,375649517,885472878,954485787,876543839,751559085,972589469,169600943,44744871,251866463,663129698,951710818,449829654,619602227,782622018,683406222,472173275,639837046,724178740,324406348,392886594,431250418,516447581,500117905,127637632,769921513,990697344,714047237,754333614,858751139,519326585,972344183,413731384,262769592,515682847,607245302,959089892,967733874,929742164,617837255,662361835,66214261,938608321,977384292,397718413,15736401,87825483,287454512,854080833,805319991,300581598,940290789,504762281,287142706,956290853,71166393,358955276,680466606,954856050,141576754,933473870,571425365,84884538,92039615,757655498,55501149,281376571,463424524,163589893,319642147,198643006,689184898,320292205,819581538,510032666,602203229,227281908,213758920,546626839,5861231,282123850,632204434,711391648,447138443,151525316,789512883,217907898,247716000,62970327,550785995,831691522,451353027,286197940,518771922,153139560,413520547,367403248,396227584,584142923,994985021,442022360,901675019,585585955,47261366,787674055,520372965,215210561,628885226,293887256,204810181,550484049,611700068,668615605,860888749,972283411,255748284,381826583,9852516,801184304,927858032,339532771,387452571,134328338,619770445,794298439,758060104,52873297,906562296,695310362,502449534,752036211,444850970,883652302,167088058,390165990,182174469,282458560,122765230,769418651,496939934,103777327,438896742,337585042,6658154,645468514,585650241,866112527,812106828,72097166,278401106,364423692,633940507,284856895,877814441,929422167,461792426,62977413,410914736,69712407,545629873,651534952,694190098,844103118,426684301,38704160,147665564,682422454,805305950,352153682,79097980,469295451,338153189,135429254,903295239,902808697,852972870,175505301,700896977,928319490,831389480,832072062,890956949,720375943,478030760,152840544,610978235,929811315,432008378,176819507,865737267,183148034,131717893,501675292,139151196,160962128,768881573,874524629,379780596,567077299,603086347,866533356,807511473,880057756,426469594,153770742,655580721,367661636,493793650,92857081,78549996,494113326,932678055,336119501,571098425,530342231,321531997,278640114,781054733,391107982,440029064,627098097,819327630,916571065,423429065,286772570,442058081,856518779,1578009,806411211,889550707,111822412,100301388,83265694,816406535,162409467,686663414,135753723,916298519,316365502,394234847,689003846,792239091,922860464,688647039,635277727,312342291,993109534,449517651,221844548,376598561,117290883,874314260,107832856,170862693,775231639,148416383,320873996,551773538,196157752,171134702,340534145,225510734,600569515,997756336,778545220,111638286,299811620,651981026,765183296,468849395,349715662,408709644,333072131,134000274,68578516,463811739,581757690,106045545,109504210,871542025,731450858,404866021,543129142,873237251,857010000,639124826,564643072,424824931,472818198,675864579,822894411,766342134,965628009,448263371,342203625,706537503,184505716,985468400,677089919,686441098,596425722,26548287,78875091,589209229,520280282,276911263,772932251,825901558,549714027,62935414,537714487,276786856,81587952,8342728,572808661,277550496,823833892,220946556,180444477,71172489,472352005,618088946,875792200,940711387,374763536,378176973,944641492,636632673,25034648,733684562,520841858,881807220,617751789,38887100,693133000,857157798,995820050,425457084,390326423,877811237,340052020,830277906,984831192,262464974,632596346,436191871,985400631,952110632,439389033,631922641,508484340,591561216,443470221,220757937,466116925,120857928,908719423,51956630,775013918,192771987,643595575,515172222,12818477,410044210,371615356,911473533,840001486,207986477,180412394,320424628,69925706,627721457,150130715,790243641,131092867,246489766,229045989,393806592,685270340,950244186,517094566,669401425,120831424,825708570,135438322,379900369,183652226,346215625,196510232,873626956,854010264,555105550,586031820,547773156,329297349,669059496,543527842,901774451,559523125,654898391,677180457,184194985,139073111,985382866,675415219,133693289,211677540,20762452,685676896,202158399,632988619,76278409,713946890,39058886,370775909,784296037,811623009,890602695,99003825,858674097,462695827,452961132,1051788,134343357,345875247,369522311,289743626,868355086,521914409,129669878,455816618,800639573,706906111,891150054,974127780,945434475,437598988,960485432,318395563,642376868,74778589,529246701,339436110,608207954,372188045,968011384,792788328,574371701,284468029,489742993,712421024,184809295,896060397,153108946,682854823,671670052,650676484,384185183,613960122,555964824,724923549,555855132,313735284,830958536,84710661,253157062,830256448,146852258,406503917,227853263,479593993,653456532,38656811,277942187,692371581,588043727,537700010,410414672,137384514,392345365,351473913,521430346,324512699,509401435,486482921,440328031,546237553,646574639,316256509,43792607,723042238,160833148,611096558,636908721,686098694,758975471,925015653,166370601,60552284,931288002,557217359,341480229,598082091,406490974,274618178,342177605,153810822,89410477,756151237,184554910,133555393,117704206,109049177,588115042,237651785,120651218,265288453,211088443,462223397,562288229,841186218,983282275,594153330,768438517,468949818,317577684,947816711,522988930,888670999,845118214,430832732,300442121,358552668,641067379,9806707,19942895,689438097,856344046,923803585,631675356,248487104,388356168,223506391,758819366,892204731,101086993,390929048,871533053,900206864,589181045,69578704,229250565,488509698,884167668,138337245,182418408,444677798,447789244,741141159,968937787,18298101,118986545,472728848,424252575,229273922,287782582,556059255,375135703,73264146,702709728,76117966,977179070,680977948,261283363,305718319,939155755,238868945,603537051,140908784,178466533,204063028,118159605,773237755,88173323,131930408,852546102,217141975,721959161,684195951,347991345,282084911,310356371,105604144,847066408,288965650,524681618,972696076,142747372,253728706,726446705,793101182,852699872,686308647,634455399,815833099,151957729,439429915,69203953,78061248,657586534,524610766,574668160,104045839,493405932,24351080,96959118,90681435,991894948,947940546,99650363,433785088,997627692,204955633,931427079,863272818,606533521,662333864,318783108,262677125,408249161,399837131,179662024,364486782,733883214,754892219,557975489,213561013,633774240,605740452,478393996,963462919,882732565,173233069,38431724,978824530,631742089,555159624,824574180,342191902,645345280,553249346,94018608,990869163,710187700,206832023,807785773,32766348,540147847,785918384,322233419,199466819,544050022,826533294,65619025,319211742,141701637,269578691,549259578,333322039,371452031,208429733,98365684,606880068,612709589,379157239,233506137,366785331,526394823,883164943,941286757,738360183,986068939,61808644,419106467,658444848,33734194,635278171,935087539,892620964,584345978,146902452,615173880,288216224,701271888,152178871,532968936,416130587,430003793,819407072,741022894,668482997,337452079,530065294,468508219,431129976,34911255,137915478,971094000,241459363,22388624,545391165,45436296,522738267,864611358,957174581,532291312,228596034,352490419,954866312,38339552,929225325,445660284,728575909,882072516,197787804,749916947,527605888,185968310,208811669,145950034,449666103,25085294,259750723,888253736,4210636,898096345,339874299,782711379,86449622,181065127,105347834,1586289,909323018,366166267,560025364,916933732,408010245,705153919,347565391,239114264,991408185,580024586,484160763,28961001,54801582,884444956,526781134,507491446,88539718,758278507,209085356,63927010,44847051,306246350,406927538,403179657,444239221,588271917,132755517,846906266,361937963,86853323,576477976,897915877,188426668,532175288,250610703,356144651,376951880,782855464,475125612,720048431,199846692,464804455,677418674,532374093,483838156,9728104,326909820,211619855,972827912,921258882,359756654,562634750,386721938,989260912,201723479,316622719,878858337,832839783,661347551,494173030,892549607,675772835,226092325,976913295,687856386,647452842,452679767,345890505,567073682,415349062,613689067,771229102,81569709,637731325,930869490,155641969,129482215,502117120,736917477,544037911,295780990,150633970,3089124,662754159,788572529,203461781,629203709,293666674,38961841,422867208,722480338,523330231,693099624,171856022,20327930,176032531,853206558,575387541,420560000,339330178,189766902,252667106,804189916,518175328,131312206,205923930,412111845,847174931,279753480,466321863,211113064,552864099,771197906,757592402,434103927,683245298,563111294,762443779,560878141,220323649,756788616,156532697,1887429,867300361,526001986,573150213,86479807,9622324,137911196,843128927,104409344,629387276,227130235,58618590,784557803,862574856,176491842,784367143,247645927,294406024,452244110,402056906,466077404,635731687,364981710,856452128,636338941,683067981,833625844,334775094,965314470,182707542,832032526,355976596,691848268,526445993,816502045,487420633,743166997,541486306,487216201,916800953,567382739,344945291,532722628,398370373,957551585,560178656,360320890,688734772,438818195,199627741,971838776,757875825,640175356,288461597,142580852,63697629,191200238,235729904,682965238,455821604,942010722,928263414,934767103,516621421,520332197,540089367,273726665,653149890,338896059,179480849,164481745,531088286,877555757,402923325,309578133,887977597,911087481,106253309,697390704,538598242,177078924,656192973,398331576,680377076,355518915,655968732,652869224,796206544,556942959,471426912,948386912,746016012,591202585,914299460,145950896,37654839,959257741,376045156,403588813,143749460,543168416,286265766,29080482,22709194,824195413,603187312,853371759,660954624,665264658,672448562,974069926,657193715,116387564,8807287,143024467,324839963,565539769,769566227,642849558,612704060,58755652,411383742,3535177,538673525,141698781,942539547,350053884,991091160,984128328,885172414,305476352,171916908,453722070,821436875,168008026,653251641,109568169,884142305,719872281,840879906,811345591,962174923,763292567,469402896,340009643,435627652,171480310,215162101,678040442,527096562,543148652,278885329,166602350,872129443,639221040,919907283,566395532,785327968,569401256,890310434,538532416,709069816,677674595,108920300,985014540,274483262,396660273,905610568,806973595,629016346,225496990,243754581,404061270,100583804,707841126,250354906,244553745,624982133,68552099,43256068,274587389,198486411,86016097,174080449,550103670,541481950,141384488,792808274,492916443,783820960,612622499,167217933,841978190,284247382,585787497,22495445,838221440,898943482,229587077,128336494,189508321,815988213,804920186,692336932,899483794,363723479,571116566,103072332,933425501,146621076,483374808,103951731,671679194,459691162,331018639,575758306,407495854,407622518,860305376,428595455,930934428,194392412,19150381,521065824,597160434,516984210,186856554,899614606,708899592,553700087,453507446,903751694,505279431,645909705,2268576,963477414,354775508,367871967,411106911,987530436,651381783,264627299,120053331,929325269,186371978,559662743,157961054,389019642,268331286,789794149,76911622,158429312,335608893,81745910,806357363,104578339,573199207,607494675,747671004,681899753,827266761,233544368,472606377,686223423,845212155,662443577,254615506,129846935,280509204,287125116,713133395,95405315,189883801,442040276,376364529,401655910,567090394,686632864,50434041,632780883,456042282,516843482,166593269,148290792,814330766,227340270,87980747,214061648,411366220,449129786,489652351,178767963,684864369,430152937,347522999,275951340,811792931,599861168,580179042,294025894,650722967,90590454,66294677,894874567,222209612,695616791,900925925,886615455,842649505,290670750,680577900,808163132,809407004,257265964,59317435,519466245,955689466,603747862,607379070,474988090,50810514,398041700,777448141,485694439,86859922,932476546,236384268,228277162,461322790,101096508,700466426,672633844,353052658,384233101,430042633,831188310,338750047,896910032,494581698,619023890,736127282,760626080,445844089,960507888,770213978,603886830,30062914,541675348,850006916,902753710,561578564,401590463,809046364,677592632,605087083,610898971,127852281,553527806,838447039,641037775,657452571,277253412,365488291,144885969,160044873,193676747,706481923,872011977,577363598,828898451,647957491,498711457,185052657,328220620,662492056,521602447,196083420,204916567,726788376,341583193,764987530,434487345,85071721,580764981,168021809,613620120,837078129,464499062,785500879,151470864,262765125,224289676,801853738,262689689,333246878,396580840,538221171,611310217,595238425,494613228,913770577,50639474,419119154,234835976,137584399,569011457,644045624,360141412,346615727,435512563,387131030,935652704,548477133,389443616,647689025,945708021,668814105,827953394,134209109,63055996,779953487,707699723,788354747,944147173,989337603,497169123,618761524,541663963,127369687,703680364,415449201,59439867,105154112,611351890,286052183,525263867,832259938,674494180,427647129,513259292,837998570,976020108,235248430,340651842,559495635,433800388,59832244,397468397,855725018,738058495,185354792,652953734,596959091,750193238,203495847,557052998,814617648,971931115,147549885,80020515,611549821,38580221,877330153,155309332,163638645,179351672,918091405,876040263,13269792,285999546,964674089,510215945,259016197,771870252,332472572,206235334,635682175,12401110,856612441,697685796,870899740,901315810,582961300,630062764,751229397,63297617,984841847,309573774,976874161,653545436,925471014,350991808,576575229,110443902,292739596,709861872,507037632,605553406,971923394,345750944,921423998,331574557,507385441,620954782,238506643,472574362,919941162,715904621,732384723,600786509,492586638,974985663,869172058,479330091,704665424,279733189,561162308,49993291,326134143,751972340,402734090,372549669,811081200,45763489,353424343,374727858,691398176,312194302,930420367,478912589,80869190,488073808,384476334,386826539,22636460,705440382,159210054,106284414,411158942,724428530,41300878,897589224,250957813,945126110,622655059,742356334,909035148,830187782,56678634,156618363,196464208,155175034,783534986,910465165,576646439,599864081,860753236,762976113,63497484,396193897,555614055,896705227,676734169,222285895,108864422,360980813,406380930,597269398,485680084,249535053,462032193,690991079,621775353,15294213,365655152,234611469,156793013,710682989,815723464,456217430,830549128,751277254,149816456,528241045,462832191,903163799,669820636,900295416,934771334,576467052,694216067,208924024,324363242,39389386,608353536,298734574,643768499,31264223,503601333,993448616,115123107,662581546,542700815,36099711,749474215,630835278,927682802,328192772,851994963,114985260,529537817,676572058,687081631,848115301,258156932,789908503,27029570,882229341,610083775,21939929,307497394,344323798,588028098,590991671,856990122,171996872,33652377,386125582,100227932,211885944,802491009,365648587,168492571,902427837,404742037,864977221,652714498,152804259,996584309,531078227,656198025,69752147,561798153,347043360,657854093,397026737,812006135,555262740,166049393,942877595,913552026,896107433,815759632,264865520,805868766,855318729,642927518,506908435,866647936,585982742,453389306,248097406,367490936,321190874,187283641,564410525,422931375,236544316,472519846,458894017,33331652,519051329,588493192,228338397,366468971,792107087,602070067,343142569,254979661,382010872,442938412,301020470,825495431,129505064,487654092,272932086,553006597,866604947,168025690,807517866,932605972,273865626,37720355,162849637,858388648,681859781,732917062,262345231,184449572,181331395,306766112,824284809,95289305,29721163,707315349,349577091,189647775,786472644,65798882,228329131,886560096,438735082,973811356,533798507,541941179,891988915,79478635,165106821,233777811,38475106,838804764,729096355,741014017,702112683,292812885,958903208,703849526,475041110,397865542,864022232,215214313,85699283,692840628,809993310,534998983,679047072,172846017,55732724,423105437,879960360,809237832,572828690,16522724,7953012,515922842,330131475,24815663,927572501,138166279,268329114,31139776,258889211,510418340,520067441,665250623,797250459,767534125,654188422,23202993,386382049,29215138,472846827,450268750,710692138,618853513,403125731,814241837,169526574,537164024,929688873,986785332,517716907,227672803,33549970,836026194,329910218,51191126,271625155,190396652,284086188,677091114,955695171,956486019,558759239,150187118,406493447,327261030,43837585,858454211,939838216,495773530,997237953,902146119,829126710,346554718,818459840,172138243,478666236,236953931,325748195,40511308,164080645,807441214,906275095,62495676,565983748,348709792,571181238,543562928,190140745,389804561,30982861,967948284,443756069,252235888,96160564,407224801,597292265,577669070,591353827,613543171,671446966,641782074,867884795,955491192,234090947,461669749,357544445,195219219,551800214,347892112,707096156,850649853,208265910,783897858,169349284,213072721,745206279,53698560,348775631,898984521,383129471,896127768,609310865,395689456,826056406,721050995,995274379,247860361,972377793,884289271,308383662,774580828,231076094,625529636,422356477,387627446,982020905,93012623,780407512,891667725,643982846,325747456,482964467,367942905,310372185,224486320,947178728,552250877,647462278,742309424,514441335,13752948,125397804,299233733,272997852,75929001,526352403,460053791,624110423,935575243,429554440,64000290,997501261,572775283,445929742,877826235,522261710,703621538,487620168,345057434,755266350,170362043,990268695,506710180,68823720,378641436,697870405,946319924,65409186,92248230,336740313,740249672,494444555,56748405,811854945,548177663,156455003,618577014,816509513,930164609,718212833,518361569,462214678,898093659,720976644,863802157,687307254,585883068,15984462,902812747,487619333,224571018,810513768,649281744,756830613,722555767,413059816,958689497,439247529,120717358,53350568,618959829,410739580,88764623,843314803,88644404,982637794,263248303,383565182,579551068,763324345,959927310,943753499,987813488,399866038,650247118,15013755,68386788,205240708,459492627,816727532,564734296,513110332,177486556,491301210,574900901,591816614,8544897,496950566,377288645,788968136,253258318,573577419,528207640,273677994,551954664,295395015,271125633,403077183,582730371,125220729,878220793,577118427,88147499,703303491,116190945,825837645,56353357,158338643,346974873,985769232,401810638,719699339,23242088,326786414,721303667,115259147,399281635,255557306,196327149,981188351,344777266,956767424,234177287,43609802,377456139,536621812,431528674,724548325,732352984,665255619,534644797,368551,803373684,165963141,666825061,731077163,24566479,784823587,793593174,175879669,131437662,435366555,781827003,979461006,367812364,139416398,691175708,561098502,273672877,605470932,83111765,691582449,958313110,132611096,200679785,240815590,742215031,326948485,600063792,550559432,110669391,494581075,289341195,783172123,595389032,805240211,18999349,561264530,61962691,657303889,689795312,396844938,267085378,568641717,313107000,712270941,794468160,927403472,63288183,602197750,173892723,690639123,681777458,621240213,178110213,973148335,25345909,279082465,7943115,501228287,420452907,369717395,515821965,774561638,344074590,572328803,27227114,853443158,67901758,161405234,862682996,559690420,934649776,655074406,139902467,315481665,386488067,467199185,566295061,643829292,185913127,470332695,305204597,321337193,810116087,834412775,239675931,8722849,576971655,265740029,610059324,478448225,379298930,405291203,370449612,701120679,320249351,981472668,407984326,48354127,550095426,658702966,958856916,988276986,342659818,815596248,121386642,110435160,664032092,849692177,426680700,230138278,548687387,35359497,577769107,258256221,359535193,779298044,424395833,725955770,480622275,616168930,431137053,529241629,566855551,144317536,491239396,559884301,747432443,682057331,272587123,495429010,248883929,840234203,789958421,349621,299766857,829054528,521696493,19784759,128726582,891300663,870582851,796533711,201351914,763917820,154892214,29117473,104656677,147063513,915421094,856073550,623593864,810239482,281487277,429351297,716376292,997604791,89459746,774373956,448987375,932263348,231172672,663897112,62436127,558551006,461018369,174388070,145004120,814693172,625241407,190060916,393465382,501901236,380943541,563415206,396552051,255990719,325220720,300747003,947460500,643593038,979277947,266677371,35329306,796447411,579507440,951409845,85095318,100646523,386997285,804292478,740047362,204547467,673640002,361103235,39534173,974607256,851549239,597888945,505055543,644609781,128727721,398294984,377472486,777929791,621032118,421106702,828662129,309395688,73672968,113699323,238710034,470727191,109215643,812121138,535684714,563075337,218821397,196889293,33722779,37355343,700992242,954281925,487463124,477406009,918506978,911333997,842862045,392815348,758166434,438179435,905298789,475422596,899467646,371406788,429157061,579713112,365516393,679902472,424571248,216609674,17857090,260744047,129791765,648028753,483831939,838782979,95832489,453624523,731053096,231357071,570728668,98017908,734459682,653662603,852754219,699389901,153060948,131461374,769753602,816595744,213236141,484131668,846808854,962981024,605065650,118651202,21541260,185932520,195998450,266320925,710249594,870068793,162772949,196227416,248274804,718993786,555200760,216457171,569408353,630757206,556576754,978579109,579074950,449367967,613644566,282658475,223042857,852602871,257853247,48628318,437584136,248805565,433323334,480802201,626626751,7035311,205824693,200170456,80154911,866319500,160582860,831163313,324692767,441354348,393332741,191878632,710655980,576358724,875220598,45969126,133004039,778209767,893210987,186327609,430723917,227244117,258907845,549642913,409824404,859114496,109866533,401898143,724173428,340810288,419179641,729363505,384519487,385364968,961508204,159118702,309785373,53611071,841175328,55946900,877466481,665998567,878613887,643094499,707709465,405823654,249373210,16982366,99766207,197666858,136848530,304365337,922175190,560965327,566250822,656229536,185274862,539355947,745458375,986715154,709096419,447367258,899918685,276762103,896778989,492384407,192695873,576888954,101636171,406227733,680108972,79381610,489181079,227609038,442903506,976062555,992949713,918158505,254674338,399686653,81005582,493058838,769796151,961049757,801999481,961560114,265623981,914493991,276461939,223453836,165423475,581976722,819134992,231193827,843231771,17337605,692019092,895523283,828080353,235249911,119750981,731809190,909598999,439559680,180006932,696949576,929895602,444396914,900417787,366610460,725281155,481337510,696378138,952127278,139902716,40497155,963108812,123644978,648227839,119561859,620494422,166327977,556336252,484868547,565246855,559910108,638818886,591448248,979307193,971081785,8580554,563153960,798674739,968634,865865346,227025476,798799407,543287805,451732724,808546732,683591815,344694687,888396114,384044680,636815723,600312731,949513326,889052638,122757741,89097084,283494582,989263817,263379224,469341195,492484449,727490723,821777499,450752032,388700621,829968871,789084988,705687822,530659399,791222894,12786729,746342237,797778444,940459461,68831145,653655169,484258033,812588335,4124156,8724410,130654567,43405873,495984303,410794119,49135172,829047450,761281458,691256513,498945094,69195532,67248060,434351843,765558779,952039700,309706730,376612869,763388079,448841684,315025545,284179549,461878200,741129192,436126627,995631196,694241003,53958804,887427308,832327819,89270465,238828876,158464311,88023834,547451613,788224877,789821319,501541686,309551812,570247037,722322337,370464271,427172071,851495813,399719453,330319767,663051988,509012198,487674954,295734154,491889575,804621943,442462479,743905347,691948536,191883459,759318885,51293345,329313348,961762990,292544026,621575281,285016408,301568778,122741945,78612051,2764961,82047094,945340335,886827208,65665212,412955591,968341281,907901481,296955015,248376785,922627052,233480028,325631326,395287488,816297824,115246893,100012901,268980078,360327376,228741703,249629023,648126853,38407289,768978754,820831111,980961506,343165043,559917189,741532944,934084994,990944917,950301268,941593544,123492205,22299298,590576462,247764324,752447183,37872942,884954516,626522787,830611875,746790888,960870666,897518263,321716711,352231823,543662836,162552815,245212360,454184019,781821554,54666504,672683675,256050047,959399047,636680880,878829955,954847389,451742863,746882002,352841853,938735980,300546660,594658050,711490254,877772431,964865961,831532147,423542347,15264595,359367373,833479249,245931168,239729398,642990958,449158172,172013823,218249128,760049922,656990130,212944915,368630184,825261741,726583258,974284610,564621599,779778647,782754449,335032090,50704155,431170461,640992681,88003129,619708475,95309075,143079176,657023414,562886489,312638449,733745382,729050714,352725200,836428222,68896196,460680893,381641542,770325578,702209445,205404331,798391344,353310646,630062940,936074572,855832972,258617035,518049500,639064544,803102697,469472670,737202397,874073707,528896966,65025638,197327510,334365315,519139446,454102832,469138585,224171666,834676226,970742939,537970314,214934560,249361648,55833312,453199578,813448719,671194793,449808988,729349868,636843253,168252611,490296761,15589616,489033849,408350826,937775644,624260702,137104260,228950284,185236100,173495920,406026858,65699433,111536518,337662367,678409903,853043307,532532990,117668994,677405397,758206033,948506177,226647875,543713840,8601181,470852443,236544741,622156749,484557339,989022128,751200964,99748061,782061381,426604074,26202734,957647340,70628338,319119862,600283916,568335268,36640321,478471340,450855804,887099530,477632298,966231005,476482263,618149016,481640688,249852386,892919299,218156392,370016677,916422999,33690235,665026773,355727769,505710271,830723787,707569242,976664019,219055521,408970606,426266760,799245735,996488737,315178993,214402584,362624402,16368762,560852532,371726071,41505904,385034365,482132791,521671925,741045328,811675679,909129060,986991692,805239916,296035566,582459923,418241169,579376758,279315389,744207259,763363811,99085307,458202123,191791980,354455694,801156604,834882971,194662830,553483871,273877015,149040904,374024140,241359728,97555270,124685652,806145511,814872707,839711370,871084909,568944190,485096299,213950195,376112683,919188695,540195691,967740019,726631999,881687162,905652175,448631225,343568647,582385555,380346201,40116275,906043992,417234974,27497137,530352967,320544917,603774789,673323834,896109166,486742521,212766707,536629637,82037918,506312363,390712705,519976535,944543769,768938259,931788875,465785665,724721293,421228489,848186291,722191208,336906804,12474097,851445822,137321132,71727736,876152589,261719197,587363401,749213202,179868971,449790687,610789189,258324337,99380311,559468353,750316578,170417504,824418886,363170499,370026534,652032468,786235641,380562685,353095878,695676692,811041188,689293375,255379428,788615276,964630599,431560371,5625765,325532684,419404270,622988877,276899718,115911916,769480913,600383398,899483784,68795106,894653204,477164501,332094561,276888746,684452770,569421862,493107527,906455680,578664880,112392458,118690049,471417629,174541039,244000258,75675836,566355397,277518478,516820839,899699902,307247567,156569513,655748008,301960556,95215212,821066294,449355753,80842237,290761421,402473559,848055593,369452663,28762076,910697672,536091884,329747956,321307040,473767008,565368781,724149801,994658210,369396252,679090957,140336404,490027543,121706325,757427413,15450561,233732482,961315812,528239050,652059842,347390863,717150050,390784100,740843421,263458956,210427038,768120698,439132717,424637772,178784497,648315914,244771331,328417792,384962341,464031826,747195968,478383977,960017665,399779195,531575828,926366154,82628959,810624151,701843305,253905288,734172283,411282209,75318810,615144191,233112096,421310464,611189656,668614204,39673908,741790404,140803399,553334046,708189143,587802920,419034863,3954202,245191568,641682017,268783984,392503463,821078462,477706810,212390133,585877205,521605475,270515422,788556658,23849830,764741654,372924449,654480238,211868737,987241234,782630237,935246739,50182581,891378563,896666417,658997672,574710777,400803737,625117995,16174647,168956985,438976402,56731865,546408644,541439917,572483955,639400790,88968583,115531239,909200846,370958206,936757800,792850209,597722493,297385028,565223227,36439445,414730477,993375986,728723431,255529033,970382120,687752308,493919040,240981405,512694481,322180955,706997566,831661436,508018587,406675265,618897443,773565180,594744053,231403057,359749072,675801110,418225478,556001746,25118902,972590044,975341185,686448875,731568572,509087625,5239418,152842013,900826386,279863166,862068618,894106319,595511270,848831681,440165886,3133267,444954231,340427161,444263407,714374722,765723087,350998383,710219195,240473498,246190266,681767661,132782148,278667684,647628127,399539045,45233560,369622467,522541364,112325778,684540755,603151223,264645756,395567050,664827792,11227564,898163150,711922376,574005829,877420859,737271186,880321439,66679930,852146674,91499544,290639516,190829463,198112091,830665421,963616964,451116382,669962173,7143235,556005475,272315375,787729400,80097709,380331644,1968110,174303355,653435985,51989139,800916722,16838809,799948272,618399048,541783836,813321206,924293928,662559025,400026365,812850557,622459789,798810705,924198115,243718727,99761989,48401606,84501874,918375197,312187250,20521782,518084975,240170985,312925688,639233466,892158807,12926783,876452066,325832217,660475237,413686710,742616095,848916921,365449283,433392999,869046174,457435366,634838550,619778597,606825700,886557168,223783190,911011344,412286897,85230737,93019898,627816903,139360517,870771086,488346450,980503575,451089663,570005955,274887638,72898013,116343095,587558367,910601105,452058803,297719522,730600935,617435623,104649666,459273006,903305511,22238055,455957091,471996736,694291295,81566913,919789410,635060335,564220839,188152224,522565502,45558889,589721413,506177005,738630718,693924436,854916403,568771871,951659508,606823094,684508487,184733032,25394777,122153018,67217505,313238733,474255228,863429239,750709839,698261726,184904576,172664656,184914074,101491911,550663512,268661871,641646743,421116597,289156013,473197174,320727956,924881933,731494196,615192785,846529182,789187877,226826578,435077040,375626072,189387485,866590006,772849776,186311639,765249466,776214533,421009535,11270760,737999225,284619258,466036021,203319792,299784233,568373386,460342688,827437996,531357838,312387139,698062206,492442249,178797176,326770031,802632864,545286974,986865652,208669357,96111089,672931838,982425277,556355721,179904619,356287417,12439809,420453873,100022860,947373081,396467430,898271094,689827672,992193577,551639347,587551547,657605902,55007510,937025471,474380637,478099966,421932636,766648654,905678311,22509383,983834430,589596201,180557214,635354392,559213460,176120205,644377498,982799883,30698916,288724686,909701066,147656246,519156267,263102641,994851873,128040869,403215656,777662502,20396630,266543881,957118430,815320979,40364109,807530486,195150899,125058818,953650442,289869758,976679675,413736037,655510194,648061102,325231651,552568095,994549419,911795186,854319474,449864835,594844836,354142456,992527682,307402747,57140945,977480820,585439316,781569621,205658357,283965752,953315298,614003626,63914717,607109335,524128726,291760930,569699686,557552613,296135291,14571593,841832651,49252039,995026902,683233963,871972060,833497721,868560345,563508449,173434370,10293896,852520425,15810859,31534787,932303834,382256061,493945078,836776996,270347246,346452472,864984753,290883661,685722110,10293850,176981626,66045364,159444325,395260040,26271029,737378668,687485505,404938869,611867821,771584354,647935330,802679880,545406914,253246894,744047970,825431985,605481264,602979608,541105236,498573114,526969876,67292100,322829892,43351062,517829546,8790977,786146247,45044170,842079241,620192112,901197235,488835618,784190888,936303885,547030928,235054523,105993725,643524215,796158643,728088029,719859145,284848898,356983732,287172257,694331726,606437531,117318184,742463735,135216701,152174406,266665400,895722162,443901661,760361659,119557981,413262664,821590315,345603056,157657187,435461319,806920380,96132564,52433203,770962930,933298205,288904912,330432251,764488079,504208640,705707905,333458959,382454241,86960802,624336659,970027120,48144147,37563262,269168909,375821258,52402922,478899370,888668699,371886614,479545548,785672160,280904702,535951354,944478306,598456344,869552037,461721713,119197363,890425429,457953385,47679306,491586481,551182587,419112342,496040827,240882424,358897438,355703374,509551589,709273537,414808768,561200120,825822045,31388638,913029751,344584908,963198781,15150391,460568583,603659452,406814635,173697766,111768278,831271480,801260951,483794959,851911984,229698453,488400348,902744572,704675629,494547555,449065387,813657980,173717968,433124260,433524665,243886445,298304546,42497765,134687542,187331430,442758012,64327425,497171881,397241984,630848534,628856927,68805547,144394586,754280564,583119079,55228902,508556147,459264294,925161007,665101481,554731823,745923093,242608456,94627273,6494703,178666782,361450162,551891219,877511415,985232529,725798724,207924469,46652201,951969175,698859211,793538853,725569094,110304234,298564717,659906649,286187971,232101999,857568903,563334418,723636225,352172280,773580214,379005548,830753305,251558522,281960259,388642088,923067429,848332573,298969795,223927854,333460766,988407087,814296451,364721052,658450353,487724155,503390460,543036425,964737649,93234915,990042701,77311173,949551608,654986849,503498712,970339681,440886859,284118213,63592938,933719160,172761994,248427219,446326201,790780679,259370429,675964531,873850795,207303640,789260474,947801142,242256428,971333599,738633368,200461988,530509645,511599769,94672263,922071627,804183353,4016088,695603610,632907519,377351206,314704844,910373717,176146454,882211483,240816698,845063861,522916802,945674298,800840306,312004958,308641284,272088377,745073296,450386708,709944006,753959758,314792238,343272631,77430957,16395916,47225722,590892416,249539699,836809572,881792325,61175436,292484259,939878707,388783119,36373286,856864039,394255358,327940781,406444279,289672625,740101785,164471950,697475807,111587443,561046788,465741277,301640032,75703554,819455732,191933486,787802967,665071647,68742753,313684064,153775976,413398887,43143114,549357848,151953638,306838098,60725111,857534329,344593235,18750195,312468941,319145643,53300713,488509265,92163050,268487725,379431776,271321128,362953914,827011493,376697163,385699348,256045863,77010466,245760801,776326732,10471683,484327680,638955637,117588064,421227358,53944948,237659247,152353588,400729018,721719028,762349974,571865039,721611027,405714984,758294460,982811784,476267245,973575282,607519459,124486651,500463375,108698130,862113214,871929088,412138813,299969788,810998249,283518030,472662005,66601484,855224706,619600663,958743273,661932085,139707117,832848105,797687003,556081207,108618241,290990808,31034273,488826889,376902186,178127769,777653036,725368474,594745752,95582559,678348795,51430759,303339329,445822563,50562136,16482563,606799783,275898340,593058578,823378311,768143214,997881524,520171090,933531783,656977034,455725691,584464042,52246433,532828328,953997228,151214499,244865774,574752945,785457585,647354778,587776851,873969988,80975371,523872867,493078594,843910420,569939363,166111439,50386067,410139302,209527573,423686985,386052690,796670556,421963087,39776904,703468287,980888322,792294526,154693240,583132773,596069424,115426703,435786479,225089540,372045181,982955788,467137466,275818132,473475765,908840915,442989089,137073803,674496106,482017040,830685823,759087911,271100705};
namespace BSGS
{
	int a, P, block;
	unordered_map <int, int> Mem;
	void prepare(int A)
	{
		const int MOD = P;
		a = A;
		block = 1e3;
		const int a_block = power_pow(a, block);
		for (i64 i = 1, j = a_block, end_i = P / block + 1; i <= end_i; i++, (j *= a_block) %= MOD)
			if (Mem[j]) continue;
			else Mem[j] = i;
	}
	int BSGS(int b)
	{
		if (b == 1) return 0;
		const int MOD = P;
		i64 k = b;
		REP(i, 1, block)
		{
			(k *= a) %= MOD;
			if (Mem.count(k)) return Mem[k] * block - i;
		}
		return -1;
	}
}
void InIt2()
{
	BSGS::P = MOD;
	BSGS::prepare(3);
	REP(T, 1, m)
	{
		i64 x = 1;
		for (auto d : Div[to[T]])
		{
			int g = T / d;
			if (mu[d] == 1)	(x *= g) %= MOD;
			else			(x *= invs[g]) %= MOD;
		}
		gg1[T] = x;
		if (!IDDDD[x])
		{
			STACK[++TOP] = x;
			IDDDD[x] = TOP;
		}
	}
	REP(i, (TOP * alpha) + 1, TOP) Table[i] = BSGS::BSGS(STACK[i]);
	cerr<<"NICE!";
}
inline void Ins(int x)
{
	for (register auto T : Div[x])
	{
		int idd = IDDDD[gg1[T]];
		Ans += 1ll * bin[cnt[T]++] * Table[idd];
	}
}
inline void Del(int x)
{
	for (register auto T : Div[x])
	{
		int idd = IDDDD[gg1[T]];
		//for (auto d : Div[to[T]])
		//	(Ans *= SHIT::query(T / d, cnt[T], mu[d] != 1)) %= MOD;
	//	(Ans *= SHIT::query(T, --cnt[T], 0)) %= MOD;
		Ans += 1ll * bin[--cnt[T]] * (MOD - 1 - Table[idd]);
	}
}

int main()
{
#ifdef CraZYali
	file("C");
#endif
	n = read<int>();q = read<int>();
	REP(i, 1, n) a[i] = read<int>();
	m = a[1];
	REP(i, 2, n) chkmax(m, a[i]);
	REP(i, 1, m)
		REP(j, 1, m / i) Div[i * j].emplace_back(i);
	invs[0] = invs[1] = 1;
	REP(i, 2, m) invs[i] = 1ll * (MOD - MOD / i) * invs[MOD % i] % MOD;
	InIt2();
	const int block = 1000;
	REP(i, 1, n) blg[i] = (i - 1) / block + 1;
	REP(i, 1, q)
	{
		int l(read<int>()), r(read<int>());
		Q[i] = Query(l, r, i);
	}
	sort(Q + 1, Q + 1 + q);
	cerr << clock() * 1. / CLOCKS_PER_SEC << endl;
	int l = 1, r = 1;
	Ins(a[1]);
	REP(i, 1, q)
	{
		while (l > Q[i].l) Ins(a[--l]);
		while (r < Q[i].r) Ins(a[++r]);
		while (l < Q[i].l) Del(a[l++]);
		while (r > Q[i].r) Del(a[r--]);
		ans[Q[i].id] = power_pow(3, Ans % (MOD - 1));
		if (i % 5000== 0) fprintf(stderr, "Done %d / %d = %.2lf%%\n", i, q, i * 100. / q);
	}
	REP(i, 1, q) cout << ans[i] << '\n';
	cerr << clock() * 1. / CLOCKS_PER_SEC << endl;
	return 0;
}
